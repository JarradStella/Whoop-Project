-- Calorie burn rate (cal/min) by activity type --> Tableau visual 2

SELECT 
    CASE 
        WHEN activity_name = 'Pilates' THEN 'Hot Pilates'
        ELSE activity_name 
    END AS activity_name,
    COUNT(*) AS count_activities,
    SUM(calories_burned) AS total_calories_burned,
    SUM(duration_min) AS total_minutes,
    ROUND((total_calories_burned / total_minutes), 0) AS calories_per_min
FROM 
    'whoop_workouts.csv'
GROUP BY 
    activity_name
ORDER BY 
    calories_per_min DESC;
